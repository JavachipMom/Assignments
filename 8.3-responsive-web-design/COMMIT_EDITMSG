Got most of the code to work
